// ============================================
// PERFORMANCE FIXES - Critical optimizations
// ============================================

// Fix 1: Disable AOS animations on mobile (CRITICAL)
@media (max-width: 768px) {
  [data-aos] {
    animation: none !important;
    opacity: 1 !important;
    transform: none !important;
    transition: none !important;
  }
}

// Fix 2: Reduce backdrop-filter blur (HIGH PRIORITY)
@media (max-width: 1024px) {
  // Reduce blur on all glass effects
  header,
  nav,
  .glass-panel,
  .story-display,
  .flip-card-front,
  .flip-card-back,
  .timeline-arrow {
    backdrop-filter: blur(8px) !important;
    -webkit-backdrop-filter: blur(8px) !important;
  }
}

@media (max-width: 768px) {
  // Further reduce on mobile
  header,
  nav,
  .glass-panel,
  .story-display,
  .flip-card-front,
  .flip-card-back,
  .timeline-arrow {
    backdrop-filter: blur(5px) !important;
    -webkit-backdrop-filter: blur(5px) !important;
  }
}

// Fix 3: Simplify box-shadows (HIGH PRIORITY)
@media (max-width: 768px) {
  * {
    // Reduce shadow complexity on mobile
    box-shadow: none !important;
  }

  // Keep only essential shadows
  .flip-card,
  .glass-panel,
  header {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2) !important;
  }
}

// Fix 4: Optimize timeline animations (CRITICAL)
.timeline-item {
  // Reduce animation complexity
  @media (max-width: 768px) {
    animation: none !important;
    opacity: 1 !important;
    transform: none !important;
  }
}

// Fix 5: Simplify bus animations (CRITICAL)
.timeline-bus {
  // Remove expensive animations on mobile
  @media (max-width: 768px) {
    &.driving {
      animation: none !important;

      svg {
        animation: none !important;
      }

      &::after {
        display: none !important; // Remove smoke effect
      }
    }

    &.accelerating,
    &.decelerating {
      animation: none !important;
    }
  }

  // Reduce filter complexity
  @media (max-width: 768px) {
    filter: drop-shadow(0 2px 8px rgba(79, 172, 254, 0.3)) !important;

    &.driving {
      filter: drop-shadow(0 4px 12px rgba(79, 172, 254, 0.4)) !important;
    }
  }
}

// Fix 6: Disable gradient animations (MEDIUM PRIORITY)
@media (max-width: 768px) {
  .services-flip::before,
  .services-flip::after,
  .timeline-section::before {
    animation: none !important;
  }
}

// Fix 7: Optimize scroll behavior
.timeline-wrapper {
  @media (max-width: 768px) {
    scroll-behavior: auto !important; // Disable smooth scroll on mobile
  }
}

// Fix 8: Reduce animation duration on mobile
@media (max-width: 768px) {
  * {
    animation-duration: 0.2s !important;
    transition-duration: 0.2s !important;
  }

  // Exceptions for critical animations
  .timeline-bus {
    transition-duration: 1s !important;
  }

  .hamburger span {
    transition-duration: 0.3s !important;
  }
}

// Fix 9: Use GPU acceleration for critical elements
.timeline-bus,
.flip-card,
.hamburger,
.scroll-arrow {
  transform: translateZ(0);
  will-change: transform;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
}

// Fix 10: Optimize video on mobile
@media (max-width: 768px) {
  .hero-video-wrapper video {
    // Reduce video quality on mobile if needed
    transform: translateZ(0) scale(1.1);
    will-change: transform;
  }
}

// Fix 11: Disable expensive hover effects on touch devices
@media (hover: none) and (pointer: coarse) {
  *:hover {
    transform: none !important;
    box-shadow: inherit !important;
  }

  // Keep only essential hover effects
  .cta-button:hover,
  .hamburger:hover {
    transform: scale(1.05) !important;
  }
}

// Fix 12: Reduce timeline item animations
@media (max-width: 768px) {
  .timeline-item {
    @for $i from 1 through 35 {
      &:nth-child(#{$i + 1}) {
        animation-delay: 0s !important; // Remove staggered delays
      }
    }
  }
}

// Fix 13: Optimize marker animations
.timeline-marker {
  @media (max-width: 768px) {
    transition: transform 0.2s ease !important;

    &.pulse {
      animation: none !important; // Disable pulse on mobile
    }

    &:hover {
      transform: scale(1.1) !important; // Reduce scale
    }
  }
}

// Fix 14: Simplify story display animations
.story-display {
  @media (max-width: 768px) {
    &.fade-out,
    &.fade-in {
      transition: opacity 0.2s ease !important;
      transform: none !important;
    }
  }
}

// Fix 15: Optimize flip cards
.flip-card {
  @media (max-width: 768px) {
    transition: transform 0.4s ease !important; // Faster transition

    &.flipped {
      transition: transform 0.4s ease !important;
    }
  }
}

// Fix 16: Reduce header complexity on scroll
header {
  @media (max-width: 768px) {
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2) !important;
  }
}

// Fix 17: Optimize menu animations
@media (max-width: 768px) {
  nav {
    transition: right 0.3s ease !important; // Faster transition

    ul li {
      animation: slideInMenu 0.2s ease-out forwards !important;

      @for $i from 1 through 10 {
        &:nth-child(#{$i}) {
          animation-delay: #{0.05 + ($i * 0.02)}s !important; // Faster stagger
        }
      }
    }
  }
}

// Fix 18: Disable parallax effects on mobile
@media (max-width: 768px) {
  [data-parallax] {
    transform: none !important;
  }
}

// Fix 19: Optimize stats counter
@media (max-width: 768px) {
  .stat-number {
    transition: none !important;
  }
}

// Fix 20: Critical - Force hardware acceleration
@media (max-width: 768px) {
  .hero,
  .services-flip,
  .timeline-section,
  .contact-premium {
    transform: translateZ(0);
    will-change: auto; // Let browser decide
  }
}

// Fix 21: Reduce paint complexity
@media (max-width: 768px) {
  // Simplify gradients
  .hero,
  .services-flip,
  .advantages,
  .timeline-section {
    background: #0b0f19 !important; // Solid color instead of gradient
  }
}

// Fix 22: Optimize contact section
@media (max-width: 768px) {
  .contact-premium {
    .glow-bg {
      display: none !important; // Remove glow effect
    }
  }
}

// Fix 23: Disable text shadows on mobile
@media (max-width: 768px) {
  h1,
  h2,
  h3,
  .timeline-year {
    text-shadow: none !important;
  }
}

// Fix 24: Optimize footer
@media (max-width: 768px) {
  .footer-modern {
    &::before {
      display: none !important; // Remove gradient line
    }
  }
}

// Fix 25: Performance monitoring hint
body {
  // Hint to browser about performance
  @media (max-width: 768px) {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-rendering: optimizeSpeed; // Prioritize speed over quality
  }
}
